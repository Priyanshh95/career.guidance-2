{% extends "base.html" %}

{% block content %}
<div class="test-container">
    <h2 class="mb-4">Creativity Test</h2>
    
    <div class="card mb-4">
        <div class="card-body">
            <h5 class="card-title">Prompt:</h5>
            <p class="card-text">{{ prompt }}</p>
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-body">
            <form id="creativityForm" method="POST">
                <div class="mb-3">
                    <label for="story" class="form-label">Write your story:</label>
                    <textarea class="form-control" id="story" name="story" rows="5" required></textarea>
                </div>
                <button type="submit" class="btn btn-primary w-100">Submit Story</button>
            </form>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Feedback:</h5>
            <p id="feedback" class="card-text mt-3"></p>
        </div>
    </div>
</div>

<script>
    document.getElementById("creativityForm").onsubmit = async function(event) {
        event.preventDefault();
        
        let story = document.getElementById("story").value;
        
        let response = await fetch("{{ url_for('creativity_test') }}", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ "story": story })  // Ensure correct JSON format
        });
    
        let data = await response.json();
        document.getElementById("feedback").innerText = data.feedback;
    };
</script>
{% endblock %}